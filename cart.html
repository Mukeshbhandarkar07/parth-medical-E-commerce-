<!DOCTYPE html>
<html>
<head>
  <title>Cart Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

</head>
<body class="p-4 bg-black">
  <h2 class="text-center text-white">Your Cart</h2>
  <table class="table table-bordered table-striped">
    <thead class="">
      <tr>
        <th>Product</th>
        <th>Price (₹)</th>
        <th>Quantity</th>
        <th>Total (₹)</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody id="cartTable"></tbody>
  </table>
  <h4 id="grandTotal" class="text-center text-white"></h4>
  <a href="item.html" class=" btn btn-primary" >Continue Shopping</a>
  <button id="downloadPdf" class="btn btn-success">Download Invoice (PDF)</button>

  <!-- script for add item and deleting selected item -->
  <script>
    let cart = JSON.parse(localStorage.getItem("cart")) || [];
    const cartTable = document.getElementById("cartTable");

    function renderCart() {
      cartTable.innerHTML = "";
      let grandTotal = 0;

      cart.forEach((item, index) => {
        const total = item.price * item.qty;
        grandTotal += total;

        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${item.name}</td>
          <td>${item.price}</td>
          <td>${item.qty}</td>
          <td>${total}</td>
          <td>
            <button class="btn btn-danger btn-sm" onclick="removeItem(${index})">
              Delete
            </button>
          </td>
        `;
        cartTable.appendChild(row);
      });

      document.getElementById("grandTotal").textContent = `Grand Total: ₹${grandTotal}`;
      localStorage.setItem("cart", JSON.stringify(cart));
    }

    function removeItem(index) {
      if (confirm("Remove this item from cart?")) {
        cart.splice(index, 1); // remove item
        renderCart();
      }
    }

    renderCart();
    
  // script for pdf form

document.getElementById("downloadPdf").addEventListener("click", () => {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();

  // Load user details
  const user = JSON.parse(localStorage.getItem("userData")) || { name: "Guest" };

  // added logo to invoice
  const logo = new Image();
  logo.src = "invoice.png";  // make sure file exists in same folder
  logo.onload = () => {
    doc.addImage(logo, "PNG", 10, 10, 30, 30); //

    // Title name of Brand
    doc.setFontSize(18);
    doc.text("PARTH MEDICAL AGENCY", 50, 20);

    // Invoice details
    doc.setFontSize(12);
    doc.text("Customer: " + user.name, 50, 30);
    doc.text("Date: " + new Date().toLocaleDateString(), 50, 38);

    let y = 55;
    doc.text("Product", 10, y);
    doc.text("Price", 80, y);
    doc.text("Qty", 120, y);
    doc.text("Total", 160, y);
    y += 10;

    let grandTotal = 0;
    cart.forEach(item => {
      const total = item.price * item.qty;
      grandTotal += total;

      doc.text(item.name, 10, y);
      doc.text("₹" + item.price, 80, y);
      doc.text(item.qty.toString(), 120, y);
      doc.text("₹" + total, 160, y);
      y += 10;
    });

    y += 10;
    doc.setFontSize(14);
    doc.text("Grand Total: ₹" + grandTotal, 10, y);

    doc.save("invoice.pdf");
  };
});


  </script>
  
</body>
</html>
